% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/glm_evalues.R
\name{glm_lr_evalues}
\alias{glm_lr_evalues}
\title{Compute GLM Likelihood Ratio E-Values}
\usage{
glm_lr_evalues(
  y,
  X,
  theta_null,
  theta_alt,
  family = gaussian(),
  dispersion = NULL
)
}
\arguments{
\item{y}{Response vector.}

\item{X}{Design matrix.}

\item{theta_null}{Parameter value under the null hypothesis.}

\item{theta_alt}{Parameter value under the alternative hypothesis.}

\item{family}{Family object specifying the exponential family distribution.
Default is gaussian(). Supported families: gaussian, poisson, binomial,
Gamma, and negative.binomial (requires size parameter).}

\item{dispersion}{Dispersion parameter. For negative binomial, this is the
size parameter (theta). For Gamma, this is the shape parameter. If NULL,
estimated from data where appropriate.}
}
\value{
A numeric vector of per-observation e-values.
}
\description{
Computes per-observation likelihood ratio based e-variables for exponential
family GLMs. These e-values satisfy E <= 1 under the null hypothesis.
}
\details{
For each observation i, the e-value is computed as the likelihood ratio:
\deqn{e_i = \frac{L(\theta_{alt} | y_i)}{L(\theta_{null} | y_i)}}

These e-values form a test martingale under the null hypothesis, meaning
their expected value is at most 1.

Supported families:
\itemize{
  \item \strong{gaussian}: Normal distribution for continuous responses
  \item \strong{poisson}: Poisson distribution for count data
  \item \strong{binomial}: Binomial distribution for binary/proportion data
  \item \strong{Gamma}: Gamma distribution for positive continuous data
  \item \strong{negative.binomial}: Negative binomial for overdispersed counts
}
}
\examples{
# Gaussian (continuous data)
set.seed(123)
n <- 50
x <- rnorm(n)
y <- 0.3 * x + rnorm(n)
X <- cbind(1, x)
evalues_gauss <- glm_lr_evalues(y, X, theta_null = 0, theta_alt = 0.5)

# Poisson (count data)
y_count <- rpois(n, lambda = exp(0.5 * x))
evalues_pois <- glm_lr_evalues(y_count, X, theta_null = 0, theta_alt = 0.5,
                                family = poisson())

# Binomial (binary data)
y_binary <- rbinom(n, size = 1, prob = plogis(0.5 * x))
evalues_binom <- glm_lr_evalues(y_binary, X, theta_null = 0, theta_alt = 0.5,
                                 family = binomial())

}
